From a125c823c9d448e20c3df22561e91f461cb90d40 Mon Sep 17 00:00:00 2001
From: Marek Goldmann <mgoldman@redhat.com>
Date: Mon, 11 Jun 2012 15:20:06 +0200
Subject: [PATCH 66/66] Added org.jboss.as.osgi module

---
 build/build.xml      |   58 +++++++++++++++++++++++++-------------------------
 build/pom.xml        |   20 ++++++++---------
 osgi/service/pom.xml |    4 ----
 pom.xml              |    4 ++--
 4 files changed, 41 insertions(+), 45 deletions(-)

diff --git a/build/build.xml b/build/build.xml
index edda9d5..61a3716 100644
--- a/build/build.xml
+++ b/build/build.xml
@@ -510,6 +510,10 @@
             <maven-resource group="org.jboss.as" artifact="jboss-as-network"/>
         </module-def>
 
+        <module-def name="org.jboss.as.osgi">
+            <maven-resource group="org.jboss.as" artifact="jboss-as-osgi-service"/>
+        </module-def>
+
         <module-def name="org.jboss.as.platform-mbean">
             <maven-resource group="org.jboss.as" artifact="jboss-as-platform-mbean"/>
         </module-def>
@@ -643,6 +647,27 @@
             <maven-resource group="org.jboss.msc" artifact="jboss-msc"/>
         </module-def>
 
+        <module-def name="org.jboss.osgi.framework">
+            <maven-resource group="org.jboss.osgi.deployment" artifact="jbosgi-deployment"/>
+            <maven-resource group="org.jboss.osgi.framework" artifact="jbosgi-framework-core"/>
+            <maven-resource group="org.jboss.osgi.resolver" artifact="jbosgi-resolver-api"/>
+            <maven-resource group="org.jboss.osgi.resolver" artifact="jbosgi-resolver-spi"/>
+            <maven-resource group="org.jboss.osgi.resolver" artifact="jbosgi-resolver-felix"/>
+        </module-def>
+
+        <module-def name="org.jboss.osgi.metadata">
+            <maven-resource group="org.jboss.osgi.metadata" artifact="jbosgi-metadata"/>
+        </module-def>
+
+        <module-def name="org.jboss.osgi.spi">
+            <maven-resource group="org.jboss.osgi.spi" artifact="jbosgi-spi"/>
+        </module-def>
+
+        <module-def name="org.jboss.osgi.vfs">
+            <maven-resource group="org.jboss.osgi.vfs" artifact="jbosgi-vfs"/>
+            <maven-resource group="org.jboss.osgi.vfs" artifact="jbosgi-vfs30"/>
+        </module-def>
+
         <module-def name="org.jboss.logging">
             <maven-resource group="org.jboss.logging" artifact="jboss-logging"/>
         </module-def>
@@ -778,6 +803,10 @@
 
         <module-def name="org.omg.api" />
 
+        <module-def name="org.osgi.core">
+            <maven-resource group="org.osgi" artifact="org.osgi.core"/>
+        </module-def>
+
         <module-def name="org.picketbox">
             <maven-resource group="org.picketbox" artifact="picketbox"/>
             <maven-resource group="org.picketbox" artifact="picketbox-infinispan"/>
@@ -1046,10 +1075,6 @@
             <maven-resource group="org.jboss.as" artifact="jboss-as-jpa-openjpa"/>
         </module-def>
 
-     	<module-def name="org.jboss.as.osgi">
-            <maven-resource group="org.jboss.as" artifact="jboss-as-osgi-service"/>
-        </module-def>
-
         <module-def name="org.jboss.as.webservices">
             <maven-resource group="org.jboss.as" artifact="jboss-as-webservices-server-integration"/>
             <maven-resource-with-classifier group="org.jboss.ws.cxf" artifact="jbossws-cxf-resources" classifier="jboss711"/>
@@ -1067,32 +1092,11 @@
             <maven-resource group="jboss.jaxbintros" artifact="jboss-jaxb-intros"/>
         </module-def>
 
-        <module-def name="org.jboss.osgi.framework">
-            <maven-resource group="org.jboss.osgi.deployment" artifact="jbosgi-deployment"/>
-            <maven-resource group="org.jboss.osgi.framework" artifact="jbosgi-framework-core"/>
-            <maven-resource group="org.jboss.osgi.resolver" artifact="jbosgi-resolver-api"/>
-            <maven-resource group="org.jboss.osgi.resolver" artifact="jbosgi-resolver-spi"/>
-            <maven-resource group="org.jboss.osgi.resolver" artifact="jbosgi-resolver-felix"/>
-        </module-def>
-
         <module-def name="org.jboss.osgi.repository">
             <maven-resource group="org.jboss.osgi.repository" artifact="jbosgi-repository-api"/>
             <maven-resource group="org.jboss.osgi.repository" artifact="jbosgi-repository-core"/>
         </module-def>
 
-        <module-def name="org.jboss.osgi.metadata">
-            <maven-resource group="org.jboss.osgi.metadata" artifact="jbosgi-metadata"/>
-        </module-def>
-
-        <module-def name="org.jboss.osgi.spi">
-            <maven-resource group="org.jboss.osgi.spi" artifact="jbosgi-spi"/>
-        </module-def>
-
-        <module-def name="org.jboss.osgi.vfs">
-            <maven-resource group="org.jboss.osgi.vfs" artifact="jbosgi-vfs"/>
-            <maven-resource group="org.jboss.osgi.vfs" artifact="jbosgi-vfs30"/>
-        </module-def>
-
         <module-def name="org.jboss.security.xacml">
             <maven-resource group="org.jboss.security" artifact="jbossxacml"/>
         </module-def>
@@ -1176,10 +1180,6 @@
             <maven-resource group="junit" artifact="junit"/>
         </module-def>
 
-        <module-def name="org.osgi.core">
-            <maven-resource group="org.osgi" artifact="org.osgi.core"/>
-        </module-def>
-
         <module-def name="org.picketlink">
             <maven-resource group="org.picketlink" artifact="picketlink-fed" jandex="true"/>
             <maven-resource group="org.picketlink" artifact="picketlink-bindings" jandex="true"/>
diff --git a/build/pom.xml b/build/pom.xml
index 353685b..3ca8540 100644
--- a/build/pom.xml
+++ b/build/pom.xml
@@ -429,6 +429,16 @@
 
         <dependency>
             <groupId>org.jboss.as</groupId>
+            <artifactId>jboss-as-osgi-configadmin</artifactId>
+        </dependency>
+
+        <dependency>
+            <groupId>org.jboss.as</groupId>
+            <artifactId>jboss-as-osgi-service</artifactId>
+        </dependency>
+
+        <dependency>
+            <groupId>org.jboss.as</groupId>
             <artifactId>jboss-as-pojo</artifactId>
         </dependency>
 
@@ -1299,16 +1309,6 @@
 
                 <dependency>
                     <groupId>org.jboss.as</groupId>
-                    <artifactId>jboss-as-osgi-configadmin</artifactId>
-                </dependency>
-
-                <dependency>
-                    <groupId>org.jboss.as</groupId>
-                    <artifactId>jboss-as-osgi-service</artifactId>
-                </dependency>
-
-                <dependency>
-                    <groupId>org.jboss.as</groupId>
                     <artifactId>jboss-as-platform-mbean</artifactId>
                 </dependency>
 
diff --git a/osgi/service/pom.xml b/osgi/service/pom.xml
index f20f5be..338da61 100644
--- a/osgi/service/pom.xml
+++ b/osgi/service/pom.xml
@@ -90,10 +90,6 @@
             <groupId>org.osgi</groupId>
             <artifactId>org.osgi.core</artifactId>
         </dependency>
-        <dependency>
-            <groupId>org.osgi</groupId>
-            <artifactId>org.osgi.enterprise</artifactId>
-        </dependency>
 
         <!-- Test Dependencies -->
         <dependency>
diff --git a/pom.xml b/pom.xml
index 6a223d3..e0ed21d 100644
--- a/pom.xml
+++ b/pom.xml
@@ -302,6 +302,7 @@
         <module>modcluster</module>
         <module>naming</module>
         <module>network</module>
+        <module>osgi</module>
         <module>platform-mbean</module>
         <module>pojo</module>
         <module>process-controller</module>
@@ -419,7 +420,7 @@
                                             <exclude>jacorb:jacorb</exclude>
                                             <exclude>javassist:javassist</exclude>
                                             <!-- <exclude>javax.persistence:persistence-api</exclude> Needs investigation -->
-                                            <exclude>javax.servlet:servlet-api</exclude>
+                                            <!-- <exclude>javax.servlet:servlet-api</exclude> Pulled in by org.osgi:org.osgi.compendium, alias -->
                                             <exclude>javax.transaction:jta</exclude>
                                             <exclude>javax.xml:jaxrpc-api</exclude>
                                             <exclude>javax.xml.soap:saaj-api</exclude>
@@ -5983,7 +5984,6 @@
                 <module>jacorb</module>
                 -->
                 <module>jdr</module>
-                <module>osgi</module>
                 <module>remoting-test</module>
                 <module>spec-api</module>
                 <module>webservices</module>
-- 
1.7.10.2

